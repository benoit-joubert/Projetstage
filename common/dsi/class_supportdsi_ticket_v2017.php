<?php
 class SupportDsiTicket { var $db; var $ticketId = false; var $logicielId = false; var $materielId = false; var $projetId = false; var $ticketDescription = false; var $ticketScreenshot = false; var $ticketCreationTime = false; var $ticketEcheanceTime = false; var $ticketResolutionTime = false; var $ticketIsUrgent = false; var $ticketUserMatricule = false; var $ticketUserNom = false; var $ticketUserPrenom = false; var $ticketUserEmail = false; var $ticketUserTelephone = false; var $reponseId = false; var $userIdAffectation = false; var $userIdAffectationAuteur = false; var $userIdCreation = false; var $serviceId = false; var $etatId = false; var $problemeId = false; var $ticketSendMail = false; var $ticketDescriptionLive = false; var $ticketIdParent = false; var $ticketBatimentId = false; var $ticketAgentMotdir = false; var $ticketUserServiceId = false; var $typeClotureId = false; var $destinataireId = false; var $ticketAgtCreateMat = false; var $ticketAgtCreateNom = false; var $ticketIsArchive = false; function setTicketId($v) { $this->ticketId = $v; } function setLogicielId($v) { $this->logicielId = $v; } function setMaterielId($v) { $this->materielId = $v; } function setProjetId($v) { $this->projetId = $v; } function setTicketDescription($v) { $this->ticketDescription = $v; } function setTicketScreenshot($v) { $this->ticketScreenshot = $v; } function setTicketCreationTime($v) { $this->ticketCreationTime = $v; } function setTicketEcheanceTime($v) { $this->ticketEcheanceTime = $v; } function setTicketResolutionTime($v) { $this->ticketResolutionTime = $v; } function setTicketIsUrgent($v) { $this->ticketIsUrgent = $v; } function setTicketUserMatricule($v) { $this->ticketUserMatricule = $v; } function setTicketUserNom($v) { $this->ticketUserNom = $v; } function setTicketUserPrenom($v) { $this->ticketUserPrenom = $v; } function setTicketUserEmail($v) { $this->ticketUserEmail = $v; } function setTicketUserTelephone($v) { $this->ticketUserTelephone = $v; } function setReponseId($v) { $this->reponseId = $v; } function setUserIdAffectation($v) { $this->userIdAffectation = $v; } function setUserIdAffectationAuteur($v) { $this->userIdAffectationAuteur = $v; } function setUserIdCreation($v) { $this->userIdCreation = $v; } function setServiceId($v) { $this->serviceId = $v; } function setEtatId($v) { $this->etatId = $v; } function setProblemeId($v) { $this->problemeId = $v; } function setTicketSendMail($v) { $this->ticketSendMail = $v; } function setTicketDescriptionLive($v) { $this->ticketDescriptionLive = $v; } function setTicketIdParent($v) { $this->ticketIdParent = $v; } function setTicketBatimentId($v) { $this->ticketBatimentId = $v; } function setTicketAgentMotdir($v) { $this->ticketAgentMotdir = $v; } function setTicketUserServiceId($v) { $this->ticketUserServiceId = $v; } function setTypeClotureId($v) { $this->typeClotureId = $v; } function setDestinataireId($v) { $this->destinataireId = $v; } function setTicketAgtCreateMat($v) { $this->ticketAgtCreateMat = $v; } function setTicketAgtCreateNom($v) { $this->ticketAgtCreateNom = $v; } function setTicketIsArchive($v) { $this->ticketIsArchive = $v; } function getTicketId() { return $this->ticketId; } function getLogicielId() { return $this->logicielId; } function getMaterielId() { return $this->materielId; } function getProjetId() { return $this->projetId; } function getTicketDescription() { return $this->ticketDescription; } function getTicketScreenshot() { return $this->ticketScreenshot; } function getTicketCreationTime() { return $this->ticketCreationTime; } function getTicketEcheanceTime() { return $this->ticketEcheanceTime; } function getTicketResolutionTime() { return $this->ticketResolutionTime; } function getTicketIsUrgent() { return $this->ticketIsUrgent; } function getTicketUserMatricule() { return $this->ticketUserMatricule; } function getTicketUserNom() { return $this->ticketUserNom; } function getTicketUserPrenom() { return $this->ticketUserPrenom; } function getTicketUserEmail() { return $this->ticketUserEmail; } function getTicketUserTelephone() { return $this->ticketUserTelephone; } function getReponseId() { return $this->reponseId; } function getUserIdAffectation() { return $this->userIdAffectation; } function getUserIdAffectationAuteur() { return $this->userIdAffectationAuteur; } function getUserIdCreation() { return $this->userIdCreation; } function getServiceId() { return $this->serviceId; } function getEtatId() { return $this->etatId; } function getProblemeId() { return $this->problemeId; } function getTicketSendMail() { return $this->ticketSendMail; } function getTicketDescriptionLive() { return $this->ticketDescriptionLive; } function getTicketIdParent() { return $this->ticketIdParent; } function getTicketBatimentId() { return $this->ticketBatimentId; } function getTicketAgentMotdir() { return $this->ticketAgentMotdir; } function getTicketUserServiceId() { return $this->ticketUserServiceId; } function getTypeClotureId() { return $this->typeClotureId; } function getDestinataireId() { return $this->destinataireId; } function getTicketAgtCreateMat() { return $this->ticketAgtCreateMat; } function getTicketAgtCreateNom() { return $this->ticketAgtCreateNom; } function getTicketIsArchive() { return $this->ticketIsArchive; } function SupportDsiTicket($db) { return $this->db = $db; } function verifChampsNotNull() { } function verifChampsPrimaryKey() { if ($this->getTicketId() == '') die('Exécution impossible car le champs OBLIGATOIRE `ticket_id` n\'a pas de valeur!'); } function insert() { $this->verifChampsPrimaryKey(); $req = 'insert into supportdsi.ticket '. '('. 'ticket_id, '. 'logiciel_id, '. 'materiel_id, '. 'projet_id, '. 'ticket_description, '. 'ticket_screenshot, '. 'ticket_creation_time, '. 'ticket_echeance_time, '. 'ticket_resolution_time, '. 'ticket_is_urgent, '. 'ticket_user_matricule, '. 'ticket_user_nom, '. 'ticket_user_prenom, '. 'ticket_user_email, '. 'ticket_user_telephone, '. 'reponse_id, '. 'user_id_affectation, '. 'user_id_affectation_auteur, '. 'user_id_creation, '. 'service_id, '. 'etat_id, '. 'probleme_id, '. 'ticket_send_mail, '. 'ticket_description_live, '. 'ticket_id_parent, '. 'ticket_batiment_id, '. 'ticket_agent_motdir, '. 'ticket_user_service_id, '. 'type_cloture_id, '. 'destinataire_id, '. 'ticket_agt_create_mat, '. 'ticket_agt_create_nom, '. 'ticket_is_archive, '. ') '. 'values ('. ($this->ticketId != '' ? '\''. protegeChaine($this->getTicketId()) .'\', ':'NULL, '). ($this->logicielId != '' ? '\''. protegeChaine($this->getLogicielId()) .'\', ':'NULL, '). ($this->materielId != '' ? '\''. protegeChaine($this->getMaterielId()) .'\', ':'NULL, '). ($this->projetId != '' ? '\''. protegeChaine($this->getProjetId()) .'\', ':'NULL, '). ($this->ticketDescription != '' ? '\''. protegeChaine($this->getTicketDescription()) .'\', ':'NULL, '). ($this->ticketScreenshot != '' ? '\''. protegeChaine($this->getTicketScreenshot()) .'\', ':'NULL, '). ($this->ticketCreationTime != '' ? '\''. protegeChaine($this->getTicketCreationTime()) .'\', ':'NULL, '). ($this->ticketEcheanceTime != '' ? '\''. protegeChaine($this->getTicketEcheanceTime()) .'\', ':'NULL, '). ($this->ticketResolutionTime != '' ? '\''. protegeChaine($this->getTicketResolutionTime()) .'\', ':'NULL, '). ($this->ticketIsUrgent != '' ? '\''. protegeChaine($this->getTicketIsUrgent()) .'\', ':'NULL, '). ($this->ticketUserMatricule != '' ? '\''. protegeChaine($this->getTicketUserMatricule()) .'\', ':'NULL, '). ($this->ticketUserNom != '' ? '\''. protegeChaine($this->getTicketUserNom()) .'\', ':'NULL, '). ($this->ticketUserPrenom != '' ? '\''. protegeChaine($this->getTicketUserPrenom()) .'\', ':'NULL, '). ($this->ticketUserEmail != '' ? '\''. protegeChaine($this->getTicketUserEmail()) .'\', ':'NULL, '). ($this->ticketUserTelephone != '' ? '\''. protegeChaine($this->getTicketUserTelephone()) .'\', ':'NULL, '). ($this->reponseId != '' ? '\''. protegeChaine($this->getReponseId()) .'\', ':'NULL, '). ($this->userIdAffectation != '' ? '\''. protegeChaine($this->getUserIdAffectation()) .'\', ':'NULL, '). ($this->userIdAffectationAuteur != '' ? '\''. protegeChaine($this->getUserIdAffectationAuteur()) .'\', ':'NULL, '). ($this->userIdCreation != '' ? '\''. protegeChaine($this->getUserIdCreation()) .'\', ':'NULL, '). ($this->serviceId != '' ? '\''. protegeChaine($this->getServiceId()) .'\', ':'NULL, '). ($this->etatId != '' ? '\''. protegeChaine($this->getEtatId()) .'\', ':'NULL, '). ($this->problemeId != '' ? '\''. protegeChaine($this->getProblemeId()) .'\', ':'NULL, '). ($this->ticketSendMail != '' ? '\''. protegeChaine($this->getTicketSendMail()) .'\', ':'NULL, '). ($this->ticketDescriptionLive != '' ? '\''. protegeChaine($this->getTicketDescriptionLive()) .'\', ':'NULL, '). ($this->ticketIdParent != '' ? '\''. protegeChaine($this->getTicketIdParent()) .'\', ':'NULL, '). ($this->ticketBatimentId != '' ? '\''. protegeChaine($this->getTicketBatimentId()) .'\', ':'NULL, '). ($this->ticketAgentMotdir != '' ? '\''. protegeChaine($this->getTicketAgentMotdir()) .'\', ':'NULL, '). ($this->ticketUserServiceId != '' ? '\''. protegeChaine($this->getTicketUserServiceId()) .'\', ':'NULL, '). ($this->typeClotureId != '' ? '\''. protegeChaine($this->getTypeClotureId()) .'\', ':'NULL, '). ($this->destinataireId != '' ? '\''. protegeChaine($this->getDestinataireId()) .'\', ':'NULL, '). ($this->ticketAgtCreateMat != '' ? '\''. protegeChaine($this->getTicketAgtCreateMat()) .'\', ':'NULL, '). ($this->ticketAgtCreateNom != '' ? '\''. protegeChaine($this->getTicketAgtCreateNom()) .'\', ':'NULL, '). ($this->ticketIsArchive != '' ? '\''. protegeChaine($this->getTicketIsArchive()) .'\', ':'NULL, '). ')'; $req = str_replace(', )', ')', $req); $res = executeReq($this->db, $req); return $res; } function update() { $this->verifChampsNotNull(); $req = 'update supportdsi.ticket set '. 'logiciel_id='. ($this->logicielId != '' ? '\''. protegeChaine($this->getLogicielId()) .'\' ':'NULL '). ', materiel_id='. ($this->materielId != '' ? '\''. protegeChaine($this->getMaterielId()) .'\' ':'NULL '). ', projet_id='. ($this->projetId != '' ? '\''. protegeChaine($this->getProjetId()) .'\' ':'NULL '). ', ticket_description='. ($this->ticketDescription != '' ? '\''. protegeChaine($this->getTicketDescription()) .'\' ':'NULL '). ', ticket_screenshot='. ($this->ticketScreenshot != '' ? '\''. protegeChaine($this->getTicketScreenshot()) .'\' ':'NULL '). ', ticket_creation_time='. ($this->ticketCreationTime != '' ? '\''. protegeChaine($this->getTicketCreationTime()) .'\' ':'NULL '). ', ticket_echeance_time='. ($this->ticketEcheanceTime != '' ? '\''. protegeChaine($this->getTicketEcheanceTime()) .'\' ':'NULL '). ', ticket_resolution_time='. ($this->ticketResolutionTime != '' ? '\''. protegeChaine($this->getTicketResolutionTime()) .'\' ':'NULL '). ', ticket_is_urgent='. ($this->ticketIsUrgent != '' ? '\''. protegeChaine($this->getTicketIsUrgent()) .'\' ':'NULL '). ', ticket_user_matricule='. ($this->ticketUserMatricule != '' ? '\''. protegeChaine($this->getTicketUserMatricule()) .'\' ':'NULL '). ', ticket_user_nom='. ($this->ticketUserNom != '' ? '\''. protegeChaine($this->getTicketUserNom()) .'\' ':'NULL '). ', ticket_user_prenom='. ($this->ticketUserPrenom != '' ? '\''. protegeChaine($this->getTicketUserPrenom()) .'\' ':'NULL '). ', ticket_user_email='. ($this->ticketUserEmail != '' ? '\''. protegeChaine($this->getTicketUserEmail()) .'\' ':'NULL '). ', ticket_user_telephone='. ($this->ticketUserTelephone != '' ? '\''. protegeChaine($this->getTicketUserTelephone()) .'\' ':'NULL '). ', reponse_id='. ($this->reponseId != '' ? '\''. protegeChaine($this->getReponseId()) .'\' ':'NULL '). ', user_id_affectation='. ($this->userIdAffectation != '' ? '\''. protegeChaine($this->getUserIdAffectation()) .'\' ':'NULL '). ', user_id_affectation_auteur='. ($this->userIdAffectationAuteur != '' ? '\''. protegeChaine($this->getUserIdAffectationAuteur()) .'\' ':'NULL '). ', user_id_creation='. ($this->userIdCreation != '' ? '\''. protegeChaine($this->getUserIdCreation()) .'\' ':'NULL '). ', service_id='. ($this->serviceId != '' ? '\''. protegeChaine($this->getServiceId()) .'\' ':'NULL '). ', etat_id='. ($this->etatId != '' ? '\''. protegeChaine($this->getEtatId()) .'\' ':'NULL '). ', probleme_id='. ($this->problemeId != '' ? '\''. protegeChaine($this->getProblemeId()) .'\' ':'NULL '). ', ticket_send_mail='. ($this->ticketSendMail != '' ? '\''. protegeChaine($this->getTicketSendMail()) .'\' ':'NULL '). ', ticket_description_live='. ($this->ticketDescriptionLive != '' ? '\''. protegeChaine($this->getTicketDescriptionLive()) .'\' ':'NULL '). ', ticket_id_parent='. ($this->ticketIdParent != '' ? '\''. protegeChaine($this->getTicketIdParent()) .'\' ':'NULL '). ', ticket_batiment_id='. ($this->ticketBatimentId != '' ? '\''. protegeChaine($this->getTicketBatimentId()) .'\' ':'NULL '). ', ticket_agent_motdir='. ($this->ticketAgentMotdir != '' ? '\''. protegeChaine($this->getTicketAgentMotdir()) .'\' ':'NULL '). ', ticket_user_service_id='. ($this->ticketUserServiceId != '' ? '\''. protegeChaine($this->getTicketUserServiceId()) .'\' ':'NULL '). ', type_cloture_id='. ($this->typeClotureId != '' ? '\''. protegeChaine($this->getTypeClotureId()) .'\' ':'NULL '). ', destinataire_id='. ($this->destinataireId != '' ? '\''. protegeChaine($this->getDestinataireId()) .'\' ':'NULL '). ', ticket_agt_create_mat='. ($this->ticketAgtCreateMat != '' ? '\''. protegeChaine($this->getTicketAgtCreateMat()) .'\' ':'NULL '). ', ticket_agt_create_nom='. ($this->ticketAgtCreateNom != '' ? '\''. protegeChaine($this->getTicketAgtCreateNom()) .'\' ':'NULL '). ', ticket_is_archive='. ($this->ticketIsArchive != '' ? '\''. protegeChaine($this->getTicketIsArchive()) .'\' ':'NULL '). 'WHERE ticket_id=\''. protegeChaine($this->getTicketId()) .'\' '. ''; $res = executeReq($this->db, $req); return $res; } function delete() { $this->verifChampsNotNull(); $req = 'delete from supportdsi.ticket '. 'WHERE ticket_id=\''. protegeChaine($this->getTicketId()) .'\' '. ''; $res = executeReq($this->db, $req); return $res; } function select($where = array()) { $req = 'SELECT ticket_id, logiciel_id, materiel_id, projet_id, ticket_description, ticket_screenshot, ticket_creation_time, ticket_echeance_time, ticket_resolution_time, ticket_is_urgent, ticket_user_matricule, ticket_user_nom, ticket_user_prenom, ticket_user_email, ticket_user_telephone, reponse_id, user_id_affectation, user_id_affectation_auteur, user_id_creation, service_id, etat_id, probleme_id, ticket_send_mail, ticket_description_live, ticket_id_parent, ticket_batiment_id, ticket_agent_motdir, ticket_user_service_id, type_cloture_id, destinataire_id, ticket_agt_create_mat, ticket_agt_create_nom, ticket_is_archive '. 'FROM supportdsi.ticket '; $chWhere = ''; foreach($where as $k => $v) { if ($chWhere != '') $chWhere .= 'AND '; else $chWhere .= 'WHERE '; $chWhere .= $k .'=\''. protegeChaine($v) .'\' '; } $req .= $chWhere; $res = executeReq($this->db, $req); while(list($ticket_id, $logiciel_id, $materiel_id, $projet_id, $ticket_description, $ticket_screenshot, $ticket_creation_time, $ticket_echeance_time, $ticket_resolution_time, $ticket_is_urgent, $ticket_user_matricule, $ticket_user_nom, $ticket_user_prenom, $ticket_user_email, $ticket_user_telephone, $reponse_id, $user_id_affectation, $user_id_affectation_auteur, $user_id_creation, $service_id, $etat_id, $probleme_id, $ticket_send_mail, $ticket_description_live, $ticket_id_parent, $ticket_batiment_id, $ticket_agent_motdir, $ticket_user_service_id, $type_cloture_id, $destinataire_id, $ticket_agt_create_mat, $ticket_agt_create_nom, $ticket_is_archive) = $res->fetchRow()) { $this->setTicketId($ticket_id); $this->setLogicielId($logiciel_id); $this->setMaterielId($materiel_id); $this->setProjetId($projet_id); $this->setTicketDescription($ticket_description); $this->setTicketScreenshot($ticket_screenshot); $this->setTicketCreationTime($ticket_creation_time); $this->setTicketEcheanceTime($ticket_echeance_time); $this->setTicketResolutionTime($ticket_resolution_time); $this->setTicketIsUrgent($ticket_is_urgent); $this->setTicketUserMatricule($ticket_user_matricule); $this->setTicketUserNom($ticket_user_nom); $this->setTicketUserPrenom($ticket_user_prenom); $this->setTicketUserEmail($ticket_user_email); $this->setTicketUserTelephone($ticket_user_telephone); $this->setReponseId($reponse_id); $this->setUserIdAffectation($user_id_affectation); $this->setUserIdAffectationAuteur($user_id_affectation_auteur); $this->setUserIdCreation($user_id_creation); $this->setServiceId($service_id); $this->setEtatId($etat_id); $this->setProblemeId($probleme_id); $this->setTicketSendMail($ticket_send_mail); $this->setTicketDescriptionLive($ticket_description_live); $this->setTicketIdParent($ticket_id_parent); $this->setTicketBatimentId($ticket_batiment_id); $this->setTicketAgentMotdir($ticket_agent_motdir); $this->setTicketUserServiceId($ticket_user_service_id); $this->setTypeClotureId($type_cloture_id); $this->setDestinataireId($destinataire_id); $this->setTicketAgtCreateMat($ticket_agt_create_mat); $this->setTicketAgtCreateNom($ticket_agt_create_nom); $this->setTicketIsArchive($ticket_is_archive); } } function help() { $tab = get_class_methods($this); echo '<br>Liste des fonctions de la classe <b>Ticket</b> : <br>'; foreach($tab as $methodeName) { $methodeName = str_replace('set', '<font color=red>set</font>', $methodeName); $methodeName = str_replace('get', '<font color=green>get</font>', $methodeName); $methodeName = str_replace('select', '<font color=#E45000>select</font>', $methodeName); $methodeName = str_replace('update', '<font color=#E45000>update</font>', $methodeName); $methodeName = str_replace('delete', '<font color=#E45000>delete</font>', $methodeName); $methodeName = str_replace('insert', '<font color=#E45000>insert</font>', $methodeName); echo 'function '. $methodeName.'(...)<br>'; } } } ?>